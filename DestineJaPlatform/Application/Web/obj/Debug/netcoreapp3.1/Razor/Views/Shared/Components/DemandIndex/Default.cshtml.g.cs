#pragma checksum "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "8099ffa1f05f6d009b2afca875f7d60cf781f013"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Shared_Components_DemandIndex_Default), @"mvc.1.0.view", @"/Views/Shared/Components/DemandIndex/Default.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "C:\repositorios\DestineJaPlatform\Application\Web\Views\_ViewImports.cshtml"
using Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\repositorios\DestineJaPlatform\Application\Web\Views\_ViewImports.cshtml"
using Web.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\repositorios\DestineJaPlatform\Application\Web\Views\_ViewImports.cshtml"
using Web.Utils;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\repositorios\DestineJaPlatform\Application\Web\Views\_ViewImports.cshtml"
using DTO.Utils;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\repositorios\DestineJaPlatform\Application\Web\Views\_ViewImports.cshtml"
using DTO.Shared;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"8099ffa1f05f6d009b2afca875f7d60cf781f013", @"/Views/Shared/Components/DemandIndex/Default.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"b42406f827f578580248b07848ae56f582b2639c", @"/Views/_ViewImports.cshtml")]
    public class Views_Shared_Components_DemandIndex_Default : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("asp-cut-key", "demand-index", global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Web.Utils.TagHelperScriptCut __Web_Utils_TagHelperScriptCut;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral(@"
<div class=""row"" id=""demand-index-table-filter-area"">
    <div class=""col-md form-group"">
        <input type=""text"" class=""form-control"" placeholder=""Pesquisar"" data-toggle=""search-datatable"" data-target=""#demand-table"" />
    </div>
    <div class=""col-md-auto col-12 form-group"">
        <input type=""text"" class=""form-control"" placeholder=""MTR de Coleta"" id=""demand-search"" onkeyup=""demandSearch()"" />
    </div>
    <div class=""col-md-auto col-12 form-group"">
        ");
#nullable restore
#line 13 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
   Write(Html.DropDownList("DemandStatusId", dropDownListHelper.ToSelectListItem((await demandStatusServices.GetDataAsNoTrackingAsync()).OrderBy(x => x.Order), x => x.DemandStatusId, x => x.Name, ""), "Status da Coleta", new { Class = "form-control", onchange = "demandDatatables.draw();" }));

#line default
#line hidden
#nullable disable
            WriteLiteral("\n    </div>\n    <div class=\"col-md-auto col-12 form-group\">\n        <select class=\"form-control\" name=\"StatusId\" onchange=\"demandDatatables.draw();\">\n            <option");
            BeginWriteAttribute("value", " value=\"", 1104, "\"", 1112, 0);
            EndWriteAttribute();
            WriteLiteral(">Status da Demanda</option>\n            <option value=\"1\">Aberta</option>\n            <option value=\"2\">Fechada</option>\n            <option value=\"3\">Cancelada</option>\n        </select>\n    </div>\n    <div class=\"col-md-2\">\n        <a");
            BeginWriteAttribute("href", " href=\"", 1349, "\"", 1387, 1);
#nullable restore
#line 24 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
WriteAttributeValue("", 1356, Url.Action("Manage", "Demand"), 1356, 31, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" class=\"btn btn-primary w-100\"><i class=\"simple-icon-plus\"></i>&nbsp;Novo</a>\n    </div>\n</div>\n<hr />\n<div class=\"row\">\n    <div class=\"col-12 text-center mb-1\" style=\"font-size: 18px;\">\n        <b>");
#nullable restore
#line 30 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
       Write(await demandServices.GetDemandsThisMonth());

#line default
#line hidden
#nullable disable
            WriteLiteral(@"</b> MTR(s) de Coletas feitos este mês.
    </div>
    <div class=""col table-responsive"">
        <table id=""demand-table"" class=""display nowrap table table-striped table-bordered table-condensed w-100 tablesizeline"" style=""border-collapse: collapse !important;"">
            <thead>
                <tr>
                    <th style=""text-align:center"">MTR</th>
                    <th style=""text-align:center"">Saída</th>
                    <th style=""text-align:center"">Chegada</th>
                    <th style=""text-align:center"">Rota</th>
                    <th style=""text-align:center"">Qtd Geradores</th>
                    <th style=""text-align:center"">Status</th>
                    <th style=""text-align:center"">Demanda</th>
                    <th style=""text-align:center"">MTRs Destinação</th>
                    <th width=""60px"">&nbsp;</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "8099ffa1f05f6d009b2afca875f7d60cf781f0137424", async() => {
                WriteLiteral(@"
    var demandDatatables;
    $(document).ready(function () {
        demandDatatables = $('#demand-table').DataTable({
            order: [[0, ""desc""]],
            serverSide: false,
            proccessing: true,
            searching: true,
            lengthChange: false,
            //scrollX: true,
            pageLength: 30,
            dom: 'tip',
            ajax: {
                url: '");
#nullable restore
#line 65 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                 Write(Url.Action("List", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"',
                type: 'POST'
            },
            columnDefs: [{
                targets: [0],
                orderData: [10, 9]
            }],
            columns: [
                { render: function (data, type, row) { return '<div class=""text-center"" data-sort=""' + row.demandId + '"">' + row.destinaJaDemandId + '</div>'; } },
                { render: function (data, type, row) { return '<div class=""text-center"">' + row._DepartureDate + '</div>'; } },
                { render: function (data, type, row) { return '<div class=""text-center"">' + row._ArriveDate + '</div>'; } },
                { render: function (data, type, row) { return row.routeId + ' - ' + row.routeName; } },
                { render: function (data, type, row) { return '<div class=""text-center""><a href=""javascript:openDemandClientModal(' + row.demandId + ')"">' + row.totalClient + '</a></div>'; } },
                { render: function (data, type, row) { return '<div data-demand-status-id=""' + row.demandStatusId + '"" class=""text-");
                WriteLiteral(@"center"">' + isNull(row.demandStatusName, '-') + '</div>'; } },
                { render: function (data, type, row) { return '<div data-status-id=""' + (row.cancel ? 3 : (row.closed ? 2 : (row.cancel ? 3 : 1))) + '"" class=""text-center"">' + (row.closed ? 'Fechada' : (row.cancel? 'Cancelada' : 'Aberta')) + '</div>'; } },
                { render: function (data, type, row) { return '<div class=""text-center"">' + isNull(row.demandDestinationIds, '-') + '</div>'; } },
                {
                    render: function (data, type, row) {
                        var r = '<div class=""text-center"">';

                        if (!row.cancel) {
                            r += '<a href=\'");
#nullable restore
#line 86 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                                       Write(Url.Action("Manage", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral("?id=\' + row.demandId + \'\\\' title=\"Editar\"><span class=\"badge badge-pill badge-success\"><i class=\"simple-icon-note\"></i></span></a>\';\n                        } else {\n                            r += \'<a href=\\\'");
#nullable restore
#line 88 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                                       Write(Url.Action("Manage", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"?id=' + row.demandId + '\' title=""Visualizar""><span class=""badge badge-pill badge-success""><i class=""simple-icon-magnifier""></i></span></a>';
                        }

                        if (!row.closed && !row.cancel) {
                            r += '&nbsp;<a href=\'");
#nullable restore
#line 92 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                                             Write(Url.Action("Close", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"?id=' + row.demandId + '\' title=""Fechar Demanda""><span class=""badge badge-pill badge-primary""><i class=""fa fa-lock""></i></span></a>' +
                                '&nbsp;<a href=\'javascript:cancelDemand(' + row.demandId + ')\' title=""Cancelar""><span class=""badge badge-pill badge-danger""><i class=""simple-icon-close""></i></span></a>';
                        } else if (!row.cancel) {
                            r += '&nbsp;<a href=\'");
#nullable restore
#line 95 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                                             Write(Url.Action("Close", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"?id=' + row.demandId + '\' title=""Visualizar/Editar Fechamento""><span class=""badge badge-pill badge-primary""><i class=""fa fa-lock""></i></span></a>';
                        }
                        if (row.closed) {
                            r += '&nbsp;<a href=\'javascript:unlockDemand(""' + row.destinaJaDemandId + '"", ' + row.demandId + ')\' title=""Abrir MTR de Coleta""><span class=""badge badge-pill badge-warning""><i class=""fa fa-unlock""></i></span></a>';
                        }

                        r += '</div>';

                        return r;
                    }
                },
                { visible: false, render: function (data, type, row) { return row.destinaJaDemandId.split('/')[0]; } }
                ,{
                    visible: false, render: function (data, type, row) {
                        var split = row.destinaJaDemandId.split('/');

                        if (split.length < 2) return null;

                        return split[1];
                    }
              ");
                WriteLiteral(@"  }
                , { visible: false, render: function (data, type, row) { return row.demandClientCompanyNames; } }
                , { visible: false, render: function (data, type, row) { return row.demandClientTradeNames; } }
            ]
        });
    });


    function cancelDemand(destinaJaDemandId, demandId) {
        bootbox.prompt({
            title: ""Deseja realmente cancelar a demanda \"""" + destinaJaDemandId + ""\""?<br/>Insira o motivo a baixo:"",
            inputType: 'textarea',
            buttons: {
                confirm: {
                    label: 'Sim',
                    className: 'btn-success'
                },
                cancel: {
                    label: 'Não',
                    className: 'btn-danger mr-auto float-left'
                }
            },
            callback: function (result) {
                if (result == null) return;

                $.post('");
#nullable restore
#line 140 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                   Write(Url.Action("Cancel", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"', { demandId, reason: result }, function (d) {
                    bootbox.alert(d.message);
                    if (d.hasError) return;

                    demandDatatables.ajax.reload();
                });
            }
        });
    }

    function unlockDemand(destinaJaDemandId, demandId) {
        bootbox.prompt({
            title: ""Deseja realmente abrir a demanda \"""" + destinaJaDemandId + ""\""?<br/>Insira o motivo a baixo:"",
            inputType: 'textarea',
            buttons: {
                confirm: {
                    label: 'Sim',
                    className: 'btn-success'
                },
                cancel: {
                  label: 'Não',
                    className: 'btn-danger mr-auto float-left'
                }
            },
            callback: function (result) {
                if (result == null) return;

                $.post('");
#nullable restore
#line 167 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                   Write(Url.Action("Unlock", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"', { demandId, reason: result }, function (d) {
                    bootbox.alert(d.message);
                    if (d.hasError) return;

                    demandDatatables.ajax.reload();
                });
            }
        });
    }

    $.fn.dataTable.ext.search.push(
        function (settings, data, dataIndex) {
            if (settings.sInstance != ""demand-table"") return true;

            var r = true;

            var demandStatusID = $('#demand-index-table-filter-area [name=""DemandStatusId""]').val();

            var statusID = $('#demand-index-table-filter-area [name=""StatusId""]').val();

            r = isNullOrWhiteSpace(statusID) || statusID == $(settings.aoData[dataIndex].anCells[6]).find('[data-status-id]').data('status-id');
            r = r && (isNullOrWhiteSpace(demandStatusID) || demandStatusID == $(settings.aoData[dataIndex].anCells[5]).find('[data-demand-status-id]').data('demand-status-id'));

            return r;
        }
    );

    function openDemandClientModal(demandId)
 ");
                WriteLiteral("   {\n        $(\'#demand-index-demand-clients-view-component\').load(\'");
#nullable restore
#line 196 "C:\repositorios\DestineJaPlatform\Application\Web\Views\Shared\Components\DemandIndex\Default.cshtml"
                                                          Write(Url.Action("LoadDemandClientQuickListViewComponent", "Demand"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"', { demandId }, function () {
            $('#demand-index-demand-clients').modal('show');
            InitializeFunctions();
        });
    }

    function demandSearch() {
        demandDatatables.column(0).search($('#demand-index-table-filter-area #demand-search').val()).draw();
    }
");
            }
            );
            __Web_Utils_TagHelperScriptCut = CreateTagHelper<global::Web.Utils.TagHelperScriptCut>();
            __tagHelperExecutionContext.Add(__Web_Utils_TagHelperScriptCut);
            __Web_Utils_TagHelperScriptCut.CutKey = (string)__tagHelperAttribute_0.Value;
            __tagHelperExecutionContext.AddTagHelperAttribute(__tagHelperAttribute_0);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"

<div class=""modal fade"" id=""demand-index-demand-clients"" tabindex=""-1"" role=""dialog"" aria-hidden=""true"" style=""display: none;"">
    <div class=""modal-dialog"" role=""document"">
        <div class=""modal-content"" style=""max-width: 550px;"">
            <div class=""modal-header"">
                <h5 class=""modal-title tx-14 mg-b-0 tx-uppercase tx-inverse tx-bold"" id=""demand-index-demand-clients-title"">Geradores</h5>
                <button type=""button"" class=""close"" data-dismiss=""modal"" aria-label=""Close""><span aria-hidden=""true"">×</span></button>
            </div>
            <div class=""modal-body"">
                <div id=""demand-index-demand-clients-view-component""></div>
            </div>
            <div class=""modal-footer"">
                <div class=""col-md-12"">
                    <button type=""button"" class=""btn btn-secondary"" data-dismiss=""modal""><i class=""simple-icon-close""></i>&nbsp;Fechar</button>
                </div>
            </div>
        </div>
    </div>
</div>");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public Web.Helpers.DropDownListHelper dropDownListHelper { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public Services.Demand.DemandServices demandServices { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public Services.Demand.DemandStatusServices demandStatusServices { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
