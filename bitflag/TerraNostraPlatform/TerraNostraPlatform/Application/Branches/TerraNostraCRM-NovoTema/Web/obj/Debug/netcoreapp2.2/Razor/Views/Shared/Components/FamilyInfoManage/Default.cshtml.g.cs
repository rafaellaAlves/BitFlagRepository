#pragma checksum "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "5439f9db601f7ba20524f5a40d004d05d2c0eb61"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Shared_Components_FamilyInfoManage_Default), @"mvc.1.0.view", @"/Views/Shared/Components/FamilyInfoManage/Default.cshtml")]
[assembly:global::Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorViewAttribute(@"/Views/Shared/Components/FamilyInfoManage/Default.cshtml", typeof(AspNetCore.Views_Shared_Components_FamilyInfoManage_Default))]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#line 1 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\_ViewImports.cshtml"
using Web;

#line default
#line hidden
#line 2 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\_ViewImports.cshtml"
using DTO;

#line default
#line hidden
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"5439f9db601f7ba20524f5a40d004d05d2c0eb61", @"/Views/Shared/Components/FamilyInfoManage/Default.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"67bc2528675d6df6a8850aaaa1a29809989fa4e2", @"/Views/_ViewImports.cshtml")]
    public class Views_Shared_Components_FamilyInfoManage_Default : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<List<DTO.Family.FamilyStructureItemViewModel>>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            BeginContext(54, 2, true);
            WriteLiteral("\r\n");
            EndContext();
#line 3 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml"
  
    int applicantTypeId = (int)ViewBag.ApplicantFamilyMemberTypeId;

#line default
#line hidden
            BeginContext(132, 47, true);
            WriteLiteral("\r\n<ul class=\"list-group\" id=\"applicant-area\">\r\n");
            EndContext();
#line 8 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml"
       await Html.RenderPartialAsync("~/Views/Shared/Components/FamilyInfoManage/Shared/Recursive.cshtml", Model); 

#line default
#line hidden
            BeginContext(297, 308, true);
            WriteLiteral(@"</ul>

<script type=""text/javascript"">
    $('.changeableTitle').change(function () {
        var li = $(this).closest('li');

        var familyMemberTypeId = $(li).data('family-member-type-id');
        var fullName = $(li).find('input[name=""FullName""]').val();

        if (familyMemberTypeId == ");
            EndContext();
            BeginContext(606, 15, false);
#line 18 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml"
                             Write(applicantTypeId);

#line default
#line hidden
            EndContext();
            BeginContext(621, 2741, true);
            WriteLiteral(@") {
            $('.text-danger').remove();
            if (IsNullOrWhiteSpace(fullName)) {
                $(li).find('input[name=""FullName""]').after('<div class=""text-danger"">Insira o nome.</div>');
                return;
            }
        }

        $('.nav-link.active').text($(li).find('input[name=""FullName""]').val());
    });

    $('.changeable').change(function () {

        var li = $(this).closest('li');
        var clientId = $(li).find('input[name=""ClientId""]').val();
        var familyStructureId = $(li).data('family-structure-id');
        var clientApplicantId = $(li).data('client-applicant-id');
        var fullName = $(li).find('input[name=""FullName""]').val();
        var consortFullName = $(li).find('input[name=""ConsortFullName""]').val();
        var birthDate = $(li).find('input[name=""_BirthDate""]').val();
        var marriageDate = $(li).find('input[name=""_MarriageDate""]').val();
        var deathDate = $(li).find('input[name=""_DeathDate""]').val();
        var bir");
            WriteLiteral(@"thPlace = $(li).find('input[name=""BirthPlace""]').val();
        var marriagePlace = $(li).find('input[name=""MarriagePlace""]').val();
        var deathPlace = $(li).find('input[name=""DeathPlace""]').val();
        var email = $(li).find('input[name=""_Email""]').val(); //usado apenas pelo requerente
        var familyMemberTypeId = $(li).data('family-member-type-id');
        var dataLimiteInicial = moment('01/01/1753', 'DD-MM-YYYY');
        var dataLimiteFinal = moment('12/31/9999', 'DD-MM-YYYY');

        if (!IsNullOrWhiteSpace(birthDate)) {
            var _birthDate = moment(birthDate, 'DD-MM-YYYY');
            if (_birthDate < dataLimiteInicial || _birthDate > dataLimiteFinal) {
                alert(""Informe uma data válida"");
                $(li).find('input[name=""_BirthDate""]').val('');
                return;
            }
        }

        if (!IsNullOrWhiteSpace(marriageDate)) {
            var _marriageDate = moment(marriageDate, 'DD-MM-YYYY');
            if (_marriageDate < d");
            WriteLiteral(@"ataLimiteInicial || _marriageDate > dataLimiteFinal) {
                alert(""Informe uma data válida"");
                $(li).find('input[name=""_MarriageDate""]').val('');
                return;
            }
        }
        console.log(deathDate);
        if (!IsNullOrWhiteSpace(deathDate)) {
            var _deathDate = moment(deathDate, 'DD-MM-YYYY');
            console.log(_deathDate);
            if (_deathDate < dataLimiteInicial || _deathDate > dataLimiteFinal) {
                alert(""Informe uma data válida"");
                $(li).find('input[name=""_DeathDate""]').val('');
                return;
            }
        }

        if (familyMemberTypeId == ");
            EndContext();
            BeginContext(3363, 15, false);
#line 76 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml"
                             Write(applicantTypeId);

#line default
#line hidden
            EndContext();
            BeginContext(3378, 1008, true);
            WriteLiteral(@" && IsNullOrWhiteSpace(fullName)) {
            return;
        }

        SaveFamilyMember(li, clientId, familyStructureId, clientApplicantId, fullName, consortFullName, deathDate, birthDate, marriageDate, birthPlace, marriagePlace, deathPlace, email, this);

        updateLi(li);
    });


    function updateLi(li) {
        var familyStructureId = $(li).data('family-structure-id');

        if (hasAnyInfo(li)) {
            showChildrens(familyStructureId);
        } else {
            hideChildrens(familyStructureId);

            var parentFamilyStructureId = $(li).data('parent-family-structure-id');
            if (parentFamilyStructureId != null) {
                updateLi($('#listGroupItem' + parentFamilyStructureId));
            }
        }
    }

    function SaveFamilyMember(li, clientId, familyStructureId, clientApplicantId, fullName, consortFullName, deathDate, birthDate, marriageDate, birthPlace, marriagePlace, deathPlace, email, sel) {
        $.post('");
            EndContext();
            BeginContext(4387, 40, false);
#line 102 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml"
           Write(Url.Action("SaveFamilyMember", "Family"));

#line default
#line hidden
            EndContext();
            BeginContext(4427, 694, true);
            WriteLiteral(@"', { ClientId: clientId, FamilyStructureId: familyStructureId, ClientApplicantId: clientApplicantId, FullName: fullName, ConsortFullName: consortFullName, _DeathDate: deathDate, _BirthDate: birthDate, _MarriageDate: marriageDate, BirthPlace: birthPlace, MarriagePlace: marriagePlace, DeathPlace: deathPlace, Email: email }, function (d) {
            var alert = $('<div class=""text-success"">Dados salvos com sucesso!</div>');
            alert.fadeOut(2000);

            $(sel).after(alert);
            //'<div class=""text-danger"">Dados salvos com sucesso!</div>'
        });
    } //Chamada para salvar.

    function GetFamilyMember(clientId, familyStructureId) {
        $.get('");
            EndContext();
            BeginContext(5122, 39, false);
#line 112 "C:\repositorios\bitflag\Nova pasta\TerraNostraPlatform\Application\Branches\TerraNostraCRM-NovoTema\Web\Views\Shared\Components\FamilyInfoManage\Default.cshtml"
          Write(Url.Action("GetFamilyMember", "Family"));

#line default
#line hidden
            EndContext();
            BeginContext(5161, 3957, true);
            WriteLiteral(@"', { clientId: clientId, familyStructureId: familyStructureId }, function (d) {
        });
    }

    function showChildrens(familyStructureId) {
        $('.parent-' + familyStructureId).show();
        $.each($('.parent-' + familyStructureId), function (i, e) {
            var structureId = $(e).data('family-structure-id');

            $('#list-group-item-content-area-' + structureId).hide();
            ChangeIcon('plus', structureId);
        });
    }

    function hideChildrens(familyStructureId) {
        if (childrensHasAnyInfo(familyStructureId)) return;

        $('.parent-' + familyStructureId).hide();
    }

    function hasAnyInfo(li) {
        var fullName = $(li).find('input[name=""FullName""]').val();
        var birthDate = $(li).find('input[name=""_BirthDate""]').val();
        var marriageDate = $(li).find('input[name=""_MarriageDate""]').val();
        var deathDate = $(li).find('input[name=""_DeathDate""]').val();
        var birthPlace = $(li).find('input[name=""BirthPl");
            WriteLiteral(@"ace""]').val();
        var marriagePlace = $(li).find('input[name=""MarriagePlace""]').val();
        var deathPlace = $(li).find('input[name=""DeathPlace""]').val();

        return !IsNullOrWhiteSpace(fullName) ||
            !IsNullOrWhiteSpace(birthDate) ||
            !IsNullOrWhiteSpace(marriageDate) ||
            !IsNullOrWhiteSpace(deathDate) ||
            !IsNullOrWhiteSpace(marriagePlace) ||
            !IsNullOrWhiteSpace(birthPlace) ||
            !IsNullOrWhiteSpace(deathPlace);
    }

    function childrensHasAnyInfo(familyStructureId) {
        var flag = false;
        $.each($('.parent-' + familyStructureId), function (i, e) {
            if (hasAnyInfo(e)) {
                flag = true;
            }
        });

        return flag;
    }

    function ExpandeCollideItem(structureTypeId, force) {
        var hidded = false;

        if (force == null) {
            if ($('#list-group-item-content-area-' + structureTypeId).is("":visible"")) {
                $('#list");
            WriteLiteral(@"-group-item-content-area-' + structureTypeId).hide();
                ChangeIcon('plus', structureTypeId);
                hidded = true;
            }
            else {
                $('#list-group-item-content-area-' + structureTypeId).show();
                ChangeIcon('minus', structureTypeId);
            }
        } else {
            if (force) {
                //$('#listGroupItem' + structureTypeId).show();
                $('#list-group-item-content-area-' + structureTypeId).show();
                ChangeIcon('minus', structureTypeId);
            }
            else {
                //$('#listGroupItem' + structureTypeId).hide();
                $('#list-group-item-content-area-' + structureTypeId).hide();
                ChangeIcon('plus', structureTypeId);
            }
        }

        $.each($('.parent-' + structureTypeId), function (i, e) {
            if (force == null) ExpandeCollideItem($(e).data('family-structure-id'), !hidded);
            else ExpandeCollideIt");
            WriteLiteral(@"em($(e).data('family-structure-id'), force);
        });
    }

    function ChangeIcon(icon, structureTypeId) {
        $('#expande-collide-icon-' + structureTypeId).removeClass('simple-icon-plus');
        $('#expande-collide-icon-' + structureTypeId).removeClass('simple-icon-minus');

        $('#expande-collide-icon-' + structureTypeId).addClass('simple-icon-' + icon);
    }

 //   function _AttachmentListRemove(ownerId) {
	//	if (confirm(""Deseja realmente excluir este anexo?"")) {
 //           __AttachmentListRemove(ownerId, function () {
 //               $('#_AttachmentListTable').DataTable().ajax.reload();
 //               alert(""Anexo excluído com sucesso!"");
 //               index = attachmentIds.indexOf(ownerId);
 //               if (index !== -1)
 //                   attachmentIds.splice(index, 1);
	//		});
	//	}
	//}




</script>");
            EndContext();
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<List<DTO.Family.FamilyStructureItemViewModel>> Html { get; private set; }
    }
}
#pragma warning restore 1591
